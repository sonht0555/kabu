const a0_0x4bcd4c=a0_0x1096;(function(_0x3cfe64,_0x52cad9){const _0x40c7a1=a0_0x1096,_0xb5ad01=_0x3cfe64();while(!![]){try{const _0x4004c9=parseInt(_0x40c7a1(0x133))/0x1*(-parseInt(_0x40c7a1(0x124))/0x2)+parseInt(_0x40c7a1(0x153))/0x3+parseInt(_0x40c7a1(0x122))/0x4+parseInt(_0x40c7a1(0x162))/0x5+-parseInt(_0x40c7a1(0x110))/0x6+parseInt(_0x40c7a1(0x12d))/0x7+-parseInt(_0x40c7a1(0x101))/0x8;if(_0x4004c9===_0x52cad9)break;else _0xb5ad01['push'](_0xb5ad01['shift']());}catch(_0x46f821){_0xb5ad01['push'](_0xb5ad01['shift']());}}}(a0_0x4684,0x36856));import a0_0x56610c from'../core/mgba.js';import*as a0_0x5d05ee from'./gamepad.js';import{localStorageFile}from'./storage.js';import{dpUploadFile}from'./cloud.js';import{shaderData}from'./setting.js';import{wrapContent}from'./state.js';const Module={'canvas':document[a0_0x4bcd4c(0x12c)](a0_0x4bcd4c(0x10d))};function initializeCore(_0x5a2b24,_0x21b89c){_0x5a2b24(_0x21b89c)['then'](function(_0x161ece){const _0x4bb2f9=a0_0x1096;_0x161ece[_0x4bb2f9(0x119)]();});}initializeCore(a0_0x56610c,Module);let countAutoSave=0x0,countUpload=0x0;const canvas=document[a0_0x4bcd4c(0x12c)](a0_0x4bcd4c(0x10d)),controlSetting=document['getElementById'](a0_0x4bcd4c(0x112));function handleVisibilityChange(_0x3b2e09){const _0x35c3cf=a0_0x4bcd4c;document[_0x35c3cf(0x11b)]===_0x35c3cf(0x161)||_0x3b2e09?.['type']===_0x35c3cf(0x105)||_0x3b2e09?.[_0x35c3cf(0x134)]?(Module[_0x35c3cf(0x10f)](),pauseGame(),canvas['classList'][_0x35c3cf(0x123)]('visible')):(setTimeout(()=>{const _0x6bba19=_0x35c3cf;canvas[_0x6bba19(0x102)][_0x6bba19(0x12b)](_0x6bba19(0x164));},0x258),controlSetting[_0x35c3cf(0x102)][_0x35c3cf(0x15b)](_0x35c3cf(0x164))&&resumeGame());}async function statusShow(){const _0x30b0aa=a0_0x4bcd4c;document['addEventListener']('pagehide',handleVisibilityChange),document[_0x30b0aa(0x156)](_0x30b0aa(0x157),handleVisibilityChange),window[_0x30b0aa(0x156)](_0x30b0aa(0x105),handleVisibilityChange),restoreArea(),startTimer(),await a0_0x5d05ee['turboF'](parseInt(await getData(gameName,'0',_0x30b0aa(0x14b)))),await delay(0xc8),await Module['SDL2'](),await delay(0x320),await led(parseInt(await getData(gameName,'0','slotStateSaved'))),await notiMessage(gameVer,0x3e8),await wrapContent();}async function saveStatePeriodically(){const _0x55ce4a=a0_0x4bcd4c;await ledSave('#20A5A6'),await Module[_0x55ce4a(0x144)](0x0),await Module['FSSync'](),await screenShot(0x0),console[_0x55ce4a(0x117)]('Auto\x20save\x20'+ ++countAutoSave+_0x55ce4a(0x142));}async function saveStateInCloud(){const _0x301578=a0_0x4bcd4c,_0x1f885e=gameName['replace'](/\.(zip|gb|gbc|gba)$/,_0x301578(0x15d)),_0x42a2b6=localStorage[_0x301578(0x13a)]('uId');navigator[_0x301578(0x107)]&&(_0x42a2b6&&(await ledSave('#E0C068'),await delay(0x3e8),await dpUploadFile(_0x1f885e,Module[_0x301578(0x147)](_0x301578(0x150)+_0x1f885e),'state'),await lockNoti('',_0x301578(0x158)+ ++countUpload+'\x20time(s)',0x7d0)));}function startTimer(){let [_0x2f9666,_0x1f86b5,_0x38b6eb,_0x461806,_0x2a57c5]=[0x0,0x0,0x0,0x0,0x0];setInterval(()=>{const _0x259974=a0_0x1096;_0x38b6eb++,_0x461806++,_0x2a57c5++;if(_0x38b6eb===0x3c)[_0x38b6eb,_0x1f86b5]=[0x0,_0x1f86b5+0x1];if(_0x1f86b5===0x3c)[_0x1f86b5,_0x2f9666]=[0x0,_0x2f9666+0x1];document[_0x259974(0x12c)](_0x259974(0x132))[_0x259974(0x159)]=_0x2f9666+'h'+_0x1f86b5['toString']()[_0x259974(0x15e)](0x2,'0')+'.'+_0x38b6eb['toString']()[_0x259974(0x15e)](0x2,'0');_0x461806===0x3c&&(saveStatePeriodically(),_0x461806=0x0);;_0x2a57c5===0x708&&(saveStateInCloud(),_0x2a57c5=0x0);;},0x3e8);}export async function uploadGame(_0x5355b7){const _0x32aa1a=a0_0x4bcd4c,_0x3820c4=_0x5355b7[_0x32aa1a(0x127)][0x0];Module['uploadRom'](_0x3820c4,()=>{const _0x5895ef=_0x32aa1a;Module[_0x5895ef(0x10f)]();});}export async function loadGame(_0x32890d){const _0x1bf6d5=a0_0x4bcd4c,_0x583d01=_0x32890d[_0x1bf6d5(0x11c)](/\.(gba|gbc|gb|zip)$/,_0x1bf6d5(0x15d)),_0x19d903=Module['listStates']()[_0x1bf6d5(0x100)](_0x95ff04=>_0x95ff04!=='.'&&_0x95ff04!=='..');intro[_0x1bf6d5(0x102)][_0x1bf6d5(0x123)]('disable'),errorLogElements[0x0]['style'][_0x1bf6d5(0x163)]='0',ingame['classList'][_0x1bf6d5(0x12b)](_0x1bf6d5(0x10b)),_0x32890d[_0x1bf6d5(0x154)](_0x1bf6d5(0x136))||_0x32890d[_0x1bf6d5(0x154)](_0x1bf6d5(0x11e))?(canvas['classList'][_0x1bf6d5(0x123)](_0x1bf6d5(0x13f)),areaTrans['classList'][_0x1bf6d5(0x123)](_0x1bf6d5(0x13c)),localStorage[_0x1bf6d5(0x12a)](_0x1bf6d5(0x167),_0x1bf6d5(0x10e)+(window[_0x1bf6d5(0x10a)]-0xe6)+','+(window[_0x1bf6d5(0x10a)]-0xe6)*0x9/0xa)):localStorage[_0x1bf6d5(0x12a)]('screenSize','0,0,'+(window[_0x1bf6d5(0x10a)]-0x96)+','+(window['innerWidth']-0x96)*0x2/0x3),_0x19d903['includes'](_0x583d01)?(await Module[_0x1bf6d5(0x148)](_0x1bf6d5(0x141)+_0x32890d),confirm('Do\x20you\x20want\x20to\x20load\x20save\x20state?')&&(await Module['loadState'](0x0),await shaderData())):(await Module['loadGame']('/data/games/'+gameName),await shaderData()),await statusShow();}export async function saveState(_0x1315a9){await Module['saveState'](_0x1315a9);}export async function loadState(_0x255d8b){const _0x5a6c5d=a0_0x4bcd4c;await Module[_0x5a6c5d(0x131)](_0x255d8b);}export async function downloadFile(_0x27aa5d,_0x2b82d5){const _0x1df17f=a0_0x4bcd4c,_0x17f203=Module[_0x1df17f(0x147)](_0x27aa5d),_0x24664e=document[_0x1df17f(0x145)]('a');document['body']['appendChild'](_0x24664e),_0x24664e['download']=_0x2b82d5;const _0x4a432d=new Blob([_0x17f203],{'type':_0x1df17f(0x12e)});_0x24664e['href']=URL['createObjectURL'](_0x4a432d),_0x24664e[_0x1df17f(0x114)](),URL[_0x1df17f(0x13e)](_0x4a432d),_0x24664e[_0x1df17f(0x12b)]();}export function downloadFileInCloud(_0x473a83){try{const _0x3e8678=Module['downloadFile'](_0x473a83);return _0x3e8678;}catch(_0x42bc7c){return null;}}export async function uploadFileInCloud(_0x5e90c0){const _0x45c566=a0_0x4bcd4c;Module[_0x45c566(0x14a)](_0x5e90c0,async()=>{const _0x1cb98c=_0x45c566;localStorageFile(),await Module[_0x1cb98c(0x10f)]();});}export async function uploadFile(_0x5e5f3b){const _0x5f0f5d=a0_0x4bcd4c,_0xf9e270=_0x5e5f3b[_0x5f0f5d(0x127)][0x0];Module[_0x5f0f5d(0x14a)](_0xf9e270,async()=>{const _0x132cdc=_0x5f0f5d;localStorageFile(),await Module[_0x132cdc(0x10f)]();});}export async function editFile(_0x417a92,_0x2efe0d,_0x30b4cb){await Module['editFileName'](_0x417a92,_0x2efe0d,_0x30b4cb);}export async function deleteFile(_0x362f85){const _0x22fdc9=a0_0x4bcd4c;try{return await Module[_0x22fdc9(0x137)](_0x362f85),!![];}catch(_0x525afa){return console['error'](_0x362f85),null;}}export function listGame(){const _0x2a5716=a0_0x4bcd4c,_0x12b942=Module[_0x2a5716(0x13b)]()[_0x2a5716(0x100)](_0x42c874=>_0x42c874!=='.'&&_0x42c874!=='..');return _0x12b942;}export function listSave(){const _0x37681b=a0_0x4bcd4c,_0x4afb2b=Module[_0x37681b(0x113)]()['filter'](_0x2f82b8=>_0x2f82b8!=='.'&&_0x2f82b8!=='..');return _0x4afb2b;}export function listState(){const _0x2efa07=a0_0x4bcd4c,_0x1cae2f=Module[_0x2efa07(0x11f)]()[_0x2efa07(0x100)](_0x5d8eee=>_0x5d8eee!=='.'&&_0x5d8eee!=='..');return _0x1cae2f;}export function listCheat(){const _0x35cbdb=a0_0x4bcd4c,_0x3b9ab8=Module['listCheats']()[_0x35cbdb(0x100)](_0xc76d5a=>_0xc76d5a!=='.'&&_0xc76d5a!=='..');return _0x3b9ab8;}function a0_0x1096(_0x2d5000,_0x1ca182){const _0x4684ef=a0_0x4684();return a0_0x1096=function(_0x10962,_0x108c02){_0x10962=_0x10962-0xfe;let _0x30bd9d=_0x4684ef[_0x10962];return _0x30bd9d;},a0_0x1096(_0x2d5000,_0x1ca182);}export function listScreenshot(){const _0x41bd3f=a0_0x4bcd4c,_0x1ddc24=Module[_0x41bd3f(0x109)]()[_0x41bd3f(0x100)](_0x571a6d=>_0x571a6d!=='.'&&_0x571a6d!=='..');return _0x1ddc24;}export function fileSize(_0xc31082){const _0x264f7a=Module['fileSize'](_0xc31082);return _0x264f7a;}export async function resumeGame(){const _0x421493=a0_0x4bcd4c;Module[_0x421493(0x103)](),Module[_0x421493(0x151)](),notiMessage('Resumed!',0x7d0);}export async function pauseGame(){const _0x5ce18e=a0_0x4bcd4c;Module[_0x5ce18e(0x121)](),Module[_0x5ce18e(0x151)](),notiMessage(_0x5ce18e(0x11d),0x7d0);}export async function buttonPress(_0x3adf6c){const _0xe873a=a0_0x4bcd4c;Module[_0xe873a(0x149)](_0x3adf6c);}export async function buttonUnpress(_0x4b4c51){const _0x1bfff2=a0_0x4bcd4c;Module[_0x1bfff2(0x138)](_0x4b4c51);}export async function screenShot(_0x54b5cc){const _0x2aebf2=a0_0x4bcd4c,_0x5b3482=gameName[_0x2aebf2(0x11c)](/\.(gba|gbc|gb|zip)$/,'_'+_0x54b5cc+_0x2aebf2(0x125)),_0x4b7c4e=await getData(gameName,_0x54b5cc,_0x2aebf2(0x104))||'';console[_0x2aebf2(0x117)](_0x4b7c4e),await Module[_0x2aebf2(0x106)](_0x5b3482),await setData(gameName,_0x54b5cc,_0x2aebf2(0x12f),formatDateTime(Date[_0x2aebf2(0x111)]()),_0x4b7c4e);}function a0_0x4684(){const _0x1d6a06=['lastIndexOf','.gbc','deleteFile','buttonUnpress','encode','getItem','listRoms','gbc1','entries','revokeObjectURL','gbc','trim','/data/games/','\x20time(s)','led01','saveState','createElement','led00','downloadFile','loadGame','buttonPress','uploadAll','turboState','setVolume','led04','led06','setFastForwardMultiplier','/data/states/','SDL2','split','1040793eSksNc','endsWith','/data/screenshots/','addEventListener','visibilitychange','Cloud\x20upload\x20','textContent','\x5cs*:\x5cs*(.*?)\x5cs*(?=\x5c||$)','contains','slotStateSaved','.ss0','padStart','led05','autoLoadCheats','hidden','2086925kbEsek','bottom','visible','map','led03','screenSize','\x20:\x20','Error\x20ledSave:','style','rgba(245,\x20232,\x20209,\x200.4)','filter','5044296yRIblF','classList','resumeGame','All','beforeunload','screenshot','onLine','noti-mess','listScreenshots','innerWidth','disable','exec','canvas','0,0,','FSSync','1158468skJuHp','now','control-setting','listSaves','click','join','led0','log','tEXtComment\x00','FSInit','fill','visibilityState','replace','Paused!','.gb','listStates','error','pauseGame','1146264pqKEtp','add','526ZbITDd','.png','opacity','files','substring','image/png','setItem','remove','getElementById','2455866mllehM','application/octet-stream','saveTime','0.4','loadState','timer','1349yUefwH','persisted'];a0_0x4684=function(){return _0x1d6a06;};return a0_0x4684();}export async function dowloadScreenShot(_0x3d49b7){const _0xfab647=a0_0x4bcd4c;try{const _0x3bb235=await fileToBase64(Module[_0xfab647(0x147)](_0x3d49b7));return _0x3bb235;}catch{}}export async function captureOCR(_0x565d87){const _0x3fde3e=a0_0x4bcd4c;Module['screenshot'](_0x565d87);const _0x3a3f01=Module['downloadFile'](_0x3fde3e(0x155)+_0x565d87);return _0x3a3f01;}export async function setFastForwardMultiplier(_0x42db31){const _0x5a155a=a0_0x4bcd4c;Module[_0x5a155a(0x14f)](_0x42db31);}export async function uploadCheats(_0x1ca17f){const _0xf193e6=a0_0x4bcd4c;Module[_0xf193e6(0x160)](),Module['uploadAll'](_0x1ca17f,async()=>{});}export function setVolume(_0x885044){const _0xb8948a=a0_0x4bcd4c;Module[_0xb8948a(0x14c)](_0x885044);}export async function setData(_0xbf62d0,_0x3df324,_0x1e5a41,_0x5d4e61,_0x224e3a=''){const _0x2c5751=a0_0x4bcd4c,_0x18a485=_0xbf62d0[_0x2c5751(0x11c)](/\.(gba|gbc|gb|zip|cheats)$/,''),_0x1ce38f=_0x2c5751(0x155)+_0x18a485+'_'+_0x3df324+_0x2c5751(0x125);let _0x1f80e0;try{_0x1f80e0=await fileToBase64(Module[_0x2c5751(0x147)](_0x1ce38f));}catch(_0x4b96b0){await Module[_0x2c5751(0x106)](_0x18a485+'_'+_0x3df324+_0x2c5751(0x125)),await delay(0xc8),_0x1f80e0=await fileToBase64(Module['downloadFile'](_0x1ce38f));}let _0x4a20dc=atob(_0x1f80e0[_0x2c5751(0x152)](',')[0x1]),_0x96035e=_0x2c5751(0x118),_0xe00a60=_0x4a20dc['indexOf'](_0x96035e),_0x3682f0={};if(_0xe00a60!==-0x1||_0x224e3a['trim']()!==''){let _0x302648=_0xe00a60!==-0x1?_0x4a20dc[_0x2c5751(0x128)](_0xe00a60+_0x96035e['length']):_0x224e3a,_0x1dc6fd=/(\w+)\s*:\s*([^|]*)/g,_0x246f13;while((_0x246f13=_0x1dc6fd[_0x2c5751(0x10c)](_0x302648))!==null){_0x3682f0[_0x246f13[0x1]['trim']()]=_0x246f13[0x2]['trim']();}_0xe00a60!==-0x1&&(_0x4a20dc=_0x4a20dc[_0x2c5751(0x128)](0x0,_0xe00a60));}_0x3682f0[_0x1e5a41]=_0x5d4e61;let _0xbf42d5=Object[_0x2c5751(0x13d)](_0x3682f0)[_0x2c5751(0x165)](([_0x2e64b3,_0x4bee46])=>_0x2e64b3+_0x2c5751(0x168)+_0x4bee46)[_0x2c5751(0x115)]('\x20|\x20'),_0x4c08b0=new TextEncoder()[_0x2c5751(0x139)](_0x96035e+'\x20'+_0xbf42d5),_0x133358=new Uint8Array([..._0x4a20dc][_0x2c5751(0x165)](_0x4d9d2e=>_0x4d9d2e['charCodeAt'](0x0))['concat']([..._0x4c08b0])),_0x43f861=new File([new Blob([_0x133358],{'type':'image/png'})],_0x18a485+'_'+_0x3df324+_0x2c5751(0x125),{'type':_0x2c5751(0x129)});Module['uploadAll'](_0x43f861,async()=>{});}export async function getData(_0x32f7b9,_0x152a73,_0x4d6704){const _0x475584=a0_0x4bcd4c;try{const _0x54ca7a=_0x32f7b9[_0x475584(0x11c)](/\.(gba|gbc|gb|zip|cheats)$/,''),_0xf6cc93=_0x475584(0x155)+_0x54ca7a+'_'+_0x152a73+_0x475584(0x125);let _0x5cf5dc;try{_0x5cf5dc=await fileToBase64(Module[_0x475584(0x147)](_0xf6cc93));}catch(_0x1bab07){return null;}let _0x231471=atob(_0x5cf5dc[_0x475584(0x152)](',')[0x1]),_0x338c60=_0x475584(0x118),_0x3cc7d6=_0x231471['indexOf'](_0x338c60);if(_0x3cc7d6!==-0x1){let _0x2ee275=_0x231471[_0x475584(0x128)](_0x3cc7d6+_0x338c60['length']);if(_0x4d6704===_0x475584(0x104))return _0x2ee275[_0x475584(0x140)]();let _0x240db7=new RegExp(_0x4d6704+_0x475584(0x15a)),_0x1989fe=_0x2ee275['match'](_0x240db7);if(_0x1989fe)return _0x1989fe[0x1]['trim']();}}catch(_0x51dc3f){return console[_0x475584(0x120)]({'romName':_0x32f7b9,'slot':_0x152a73,'type':_0x4d6704}),null;}}export async function ledSave(_0x462064){const _0x452202=a0_0x4bcd4c,_0x36edbc=parseInt(await getData(gameName,'0',_0x452202(0x15c))),_0x2bb396=_0x36edbc===0x1?_0x452202(0x143):_0x36edbc===0x2?'led02':_0x36edbc===0x3?_0x452202(0x166):_0x36edbc===0x4?_0x452202(0x14d):_0x36edbc===0x5?_0x452202(0x15f):_0x36edbc===0x6?_0x452202(0x14e):_0x36edbc===0x7?'led07':_0x452202(0x146);try{for(let _0x509e1d=0x0;_0x509e1d<=0x7;_0x509e1d++){document[_0x452202(0x12c)](_0x452202(0x116)+_0x509e1d)[_0x452202(0xfe)][_0x452202(0x11a)]=_0x452202(0xff);}await delay(0x3e8);for(let _0x4c0f41=0x0;_0x4c0f41<=0x7;_0x4c0f41++){document[_0x452202(0x12c)]('led0'+_0x4c0f41)[_0x452202(0xfe)][_0x452202(0x11a)]='rgba(245,\x20232,\x20209,\x200.4)';}document[_0x452202(0x12c)](_0x2bb396)[_0x452202(0xfe)][_0x452202(0x11a)]=_0x462064;}catch(_0x1862c7){console[_0x452202(0x120)](_0x452202(0x169),_0x1862c7);}};export async function notiMessage(_0x453e09,_0x577513,_0x5968f4=![]){const _0x4c0539=a0_0x4bcd4c;var _0x50f1fe=document[_0x4c0539(0x12c)](_0x4c0539(0x108));const _0x7c62aa=parseInt(await getData(gameName,'0',_0x4c0539(0x15c)))||0x0;_0x50f1fe['style'][_0x4c0539(0x126)]===_0x4c0539(0x130)&&(clearTimeout(messageTimeout),_0x50f1fe[_0x4c0539(0xfe)]['opacity']='0'),_0x50f1fe[_0x4c0539(0x159)]=_0x453e09,_0x50f1fe[_0x4c0539(0xfe)]['opacity']=_0x4c0539(0x130),messageTimeout=setTimeout(()=>{const _0x5f2d6c=_0x4c0539;_0x50f1fe[_0x5f2d6c(0x159)]='['+_0x7c62aa+']\x20'+gameName[_0x5f2d6c(0x128)](0x0,gameName[_0x5f2d6c(0x135)]('.')),_0x50f1fe[_0x5f2d6c(0xfe)][_0x5f2d6c(0x126)]=_0x5f2d6c(0x130);},_0x577513),_0x5968f4&&(canvas[_0x4c0539(0x102)][_0x4c0539(0x123)]('visible'),setTimeout(()=>{const _0x1a79e5=_0x4c0539;canvas[_0x1a79e5(0x102)][_0x1a79e5(0x12b)](_0x1a79e5(0x164));},0x258));}export async function FSSync(){const _0x31c359=a0_0x4bcd4c;Module[_0x31c359(0x10f)]();}